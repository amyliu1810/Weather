<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: "å¾®è»Ÿæ­£é»‘é«”";
            font-weight: bold;
            font-size: 18px;
            background: #F1DE95;
        }

        .container {
            width: 100%;
            background-color: antiquewhite;
            background: linear-gradient(to bottom, #b3e5f3, #f2dd92);
        }

        .tabs {
            
            display: flex;
            padding-top: 100px;
            justify-content: center;
        }

        .tab {
            border: none;
            background-color: #F6F4EB;
            cursor: pointer;
            padding: 15px 40px;
            margin: 0 10px;
            color: #5985b1;
            box-shadow: 5px 0px 4px 0px rgba(0, 0, 0, 0.5);
            border-radius: 10px;
        }

        .tab:hover {
            background-color: #F6E7C1;
            color: #5985b1;

        }

        .locationName {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card {
            /* è—è³‡æ–™ */
            display: flex;
            flex-wrap: wrap;
            display: none;

            width: 230px;
            height: 320px;
            background-color: #F6F4EB;
            color: #5985b1;
            margin: 20px;
            padding: 15px 25px;
            line-height: 30px;
            box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5);
            text-align: center;
            border-radius: 10px;
        }

        .state {
            width: 100%;
        }
        .img {
            width: 130px;
            height: 130px;
        }

        .contents {
            padding: 30px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .active {
            background-color: rgb(67, 92, 167);
            color: white;
        }
        .showup {
            display: flex;
            justify-content: center;
        }

    </style>
</head>

<body>
    <div class="container">
        
        <div class="tabs">
            <div class="tab">å…¨è‡ºåœ°å€</div>
            <div class="tab">åŒ—éƒ¨åœ°å€</div>
            <div class="tab">ä¸­éƒ¨åœ°å€</div>
            <div class="tab">å—éƒ¨åœ°å€</div>
            <div class="tab">èŠ±æ±åœ°å€</div>
            <div class="tab">é›¢å³¶åœ°å€</div>
        </div>

        <div class="contents">
        </div>

    </div>

    <script>

        const container = document.querySelector('.container');
        const bigContents = document.querySelector('.contents');
        const tabs = document.querySelectorAll('.tab');
        // console.log(tabs);

        // å–è³‡æ–™
        fetch('https://opendata.cwb.gov.tw/api/v1/rest/datastore/F-C0032-001?Authorization=CWB-786023BA-16EC-4367-9CA7-3BA6D210B743')
            .then((response) => { // å°æ–¹å›è¦†çµ¦æˆ‘
                return response.json(); // å›å‚³Jsonæ ¼å¼çš„è³‡æ–™  response.json()
            })
            .then((data) => { // æ¥æ”¶è³‡æ–™
                console.log(data.records.location); // æ•´ç†è³‡æ–™
                let menu = data.records.location //æå–locationåœ°å€çš„è³‡æ–™,ä¸¦å„²å­˜åœ¨menu
                console.log(menu); //ç¢ºèªæ˜¯å¦å·²å„²å­˜åœ¨menuè£¡
                menu.forEach((item) => {
                    // å…ˆåˆ¤æ–·å¤©æ°£ç‹€æ³ï¼Œå†ç”Ÿæˆç›¸å°æ‡‰åœ–ç‰‡
                    let stateNum = item.weatherElement[0].time[0].parameter.parameterValue;
                    let img_path;
                    if (stateNum == 1) {
                        img_path = "./weather-img/æ™´å¤©.svg"
                    }
                    else if (stateNum == 2) {
                        img_path = "./weather-img/æ™´æ™‚å¤šé›².svg"
                    }
                    else if (stateNum == 3) {
                        img_path = "./weather-img/å¤šé›²æ™‚æ™´.svg"
                    }
                    else if (stateNum == 4) {
                        img_path = "./weather-img/å¤šé›².svg"
                    }
                    else if (stateNum == 5) {
                        img_path = "./weather-img/å¤šé›²æ™‚é™°.svg"
                    }
                    else if (stateNum == 6) {
                        img_path = "./weather-img/é™°æ™‚å¤šé›².svg"
                    }
                    else if (stateNum == 7) {
                        img_path = "./weather-img/é™°å¤©.svg"
                    }
                    else if (stateNum == 8) {
                        img_path = "./weather-img/é›¨å¤©.svg"
                    }
                    else if (stateNum == 9) {
                        img_path = "./weather-img/å¤šé›²æ™‚é™°çŸ­æš«é›¨.svg"
                    }
                    else {
                        img_path = `https://www.cwb.gov.tw/V8/assets/img/weather_icons/weathers/svg_icon/day/${stateNum}.svg`
                    }
                     //ç”Ÿæˆæ¯å€‹å€å¡Šï¼Œæ¯å±¤çš„æ’ˆè³‡æ–™ä¸¦logç¢ºèª
                    bigContents.innerHTML += `
                        <div class="card">    
                                <img class="img" src=${img_path} alt="å¤©æ°£åœ–ç‰‡">                    
                                <div class="locationName">${item.locationName}</div>
                                <div class="state">${item.weatherElement[0].time[0].parameter.parameterName}</div>
                                <div class="minT">â›„æœ€ä½æº«ï½œ${item.weatherElement[2].time[0].parameter.parameterName}Â°C</div>
                                <div class="maxT">ğŸŒæœ€é«˜æº«ï½œ${item.weatherElement[4].time[0].parameter.parameterName}Â°C</div>
                                <div class="bodyT">é«”æ„Ÿï½œ${item.weatherElement[3].time[0].parameter.parameterName}</div>
                            </div>
                            `;

                    setTimeout(() => {
                        
                        const cards = document.querySelectorAll('.card');

                        //åˆå§‹é ï¼Œç”Ÿæˆå…¨éƒ¨åœ°å€
                        cards.forEach((card) => {
                            card.classList.add('showup');
                        })
                        //è¨­ç½®tabã€å‡ºç¾å°æ‡‰è³‡æ–™
                        tabs.forEach((tab) => {
                            tab.addEventListener('click', () => {
                                tabs.forEach((item, index) => {
                                    item.classList.remove('active');
                                    cards[index].classList.remove('showup')
                                })
                                // æ¯å€‹éƒ½ç¶ä¸Šç›£è½äº‹ä»¶
                                tab.classList.add('active');

                                let all = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
                                let areaN = [1, 3, 4, 5, 7, 13, 18];
                                let areaC = [8, 9, 11, 14, 20];
                                let areaS = [0, 2, 6, 15, 17];
                                let areaE = [10, 12];
                                let areaO = [16, 19, 21];
                                
                                // å…¨éƒ¨åœ°å€
                                if (tabs[0].classList.contains('active')) {
                                    cards.forEach((card, index) => {
                                        card.classList.remove('showup');
                                        if (all.includes(index)) {
                                            card.classList.add('showup');
                                        }
                                    })
                                }
                                // åŒ—éƒ¨åœ°å€
                                else if (tabs[1].classList.contains('active')) {
                                    cards.forEach((card, index) => {
                                        card.classList.remove('showup');
                                        if (areaN.includes(index)) {
                                            card.classList.add('showup');
                                        }
                                    })
                                }
                                // ä¸­éƒ¨åœ°å€
                                else if (tabs[2].classList.contains('active')) {
                                    cards.forEach((card, index) => {
                                        card.classList.remove('showup');
                                        if (areaC.includes(index)) {
                                            card.classList.add('showup');
                                        }
                                    })
                                }
                                // å—éƒ¨åœ°å€
                                else if (tabs[3].classList.contains('active')) {
                                    cards.forEach((card, index) => {
                                        card.classList.remove('showup');
                                        if (areaS.includes(index)) {
                                            card.classList.add('showup');
                                        }
                                    })
                                }
                                // æ±éƒ¨åœ°å€
                                else if (tabs[4].classList.contains('active')) {
                                    cards.forEach((card, index) => {
                                        card.classList.remove('showup');
                                        if (areaE.includes(index)) {
                                            card.classList.add('showup');
                                        }
                                    })
                                }
                                // é›¢å³¶åœ°å€
                                else if (tabs[5].classList.contains('active')) {
                                    cards.forEach((card, index) => {
                                        card.classList.remove('showup');
                                        if (areaO.includes(index)) {
                                            card.classList.add('showup');
                                        }

                                    })
                                }
                                

                            });
                        });
                    });
                });
            });
    </script>
</body>

</html>